Sender: LSF System <lsfadmin@lo-a2-062>
Subject: Job 5241971: <python optionals/optional2/optional2.py --model GRU> in cluster <leonhard> Done

Job <python optionals/optional2/optional2.py --model GRU> was submitted from host <lo-login-01> by user <bberabi> in cluster <leonhard> at Tue Mar 17 03:34:11 2020
Job was executed on host(s) <2*lo-a2-062>, in queue <normal.24h>, as user <bberabi> in cluster <leonhard> at Tue Mar 17 03:34:36 2020
</cluster/home/bberabi> was used as the home directory.
</cluster/home/bberabi/mlfhc> was used as the working directory.
Started at Tue Mar 17 03:34:36 2020
Terminated at Tue Mar 17 04:10:44 2020
Results reported at Tue Mar 17 04:10:44 2020

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
python optionals/optional2/optional2.py --model GRU
------------------------------------------------------------

Successfully completed.

Resource usage summary:

    CPU time :                                   7064.24 sec.
    Max Memory :                                 1058 MB
    Average Memory :                             969.59 MB
    Total Requested Memory :                     4000.00 MB
    Delta Memory :                               2942.00 MB
    Max Swap :                                   -
    Max Processes :                              3
    Max Threads :                                20
    Run time :                                   2172 sec.
    Turnaround time :                            2193 sec.

The output (if any) follows:

2020-03-17 03:34:43.341336: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2020-03-17 03:34:43.349725: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2300000000 Hz
2020-03-17 03:34:43.350058: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c5d30 executing computations on platform Host. Devices:
2020-03-17 03:34:43.350082: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
Loading Model : /cluster/home/bberabi/mlfhc/models/gru/best_model_GRU_mitbih_9817.h5
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
gru_1 (GRU)                  (None, 187, 64)           12672     
_________________________________________________________________
gru_2 (GRU)                  (None, 187, 64)           24768     
_________________________________________________________________
gru_3 (GRU)                  (None, 64)                24768     
_________________________________________________________________
dense_1 (Dense)              (None, 64)                4160      
_________________________________________________________________
dense_2 (Dense)              (None, 64)                4160      
_________________________________________________________________
dense_3 (Dense)              (None, 5)                 325       
=================================================================
Total params: 70,853
Trainable params: 70,853
Non-trainable params: 0
_________________________________________________________________
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
gru_1 (GRU)                  (None, 187, 64)           12672     
_________________________________________________________________
gru_2 (GRU)                  (None, 187, 64)           24768     
_________________________________________________________________
gru_3 (GRU)                  (None, 64)                24768     
=================================================================
Total params: 62,208
Trainable params: 62,208
Non-trainable params: 0
_________________________________________________________________
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
gru_1 (GRU)                  (None, 187, 64)           12672     
_________________________________________________________________
gru_2 (GRU)                  (None, 187, 64)           24768     
_________________________________________________________________
gru_3 (GRU)                  (None, 64)                24768     
_________________________________________________________________
dense_1 (Dense)              (None, 64)                4160      
_________________________________________________________________
batch_normalization_1 (Batch (None, 64)                256       
_________________________________________________________________
dense_2 (Dense)              (None, 64)                4160      
_________________________________________________________________
batch_normalization_2 (Batch (None, 64)                256       
_________________________________________________________________
dense_3 (Dense)              (None, 64)                4160      
_________________________________________________________________
batch_normalization_3 (Batch (None, 64)                256       
_________________________________________________________________
dense_4 (Dense)              (None, 64)                4160      
_________________________________________________________________
batch_normalization_4 (Batch (None, 64)                256       
_________________________________________________________________
dense_5 (Dense)              (None, 1)                 65        
=================================================================
Total params: 79,937
Trainable params: 79,425
Non-trainable params: 512
_________________________________________________________________
Best model will be saved in  optional2_GRU.h5
Train on 10476 samples, validate on 1165 samples
Epoch 1/200
 - 51s - loss: 0.4357 - acc: 0.7955 - val_loss: 0.4665 - val_acc: 0.7219

Epoch 00001: val_acc improved from -inf to 0.72189, saving model to optional2_GRU.h5
Epoch 2/200
 - 48s - loss: 0.1804 - acc: 0.9376 - val_loss: 0.2937 - val_acc: 0.8721

Epoch 00002: val_acc improved from 0.72189 to 0.87210, saving model to optional2_GRU.h5
Epoch 3/200
 - 48s - loss: 0.1356 - acc: 0.9540 - val_loss: 0.1261 - val_acc: 0.9614

Epoch 00003: val_acc improved from 0.87210 to 0.96137, saving model to optional2_GRU.h5
Epoch 4/200
 - 48s - loss: 0.1012 - acc: 0.9655 - val_loss: 0.1038 - val_acc: 0.9674

Epoch 00004: val_acc improved from 0.96137 to 0.96738, saving model to optional2_GRU.h5
Epoch 5/200
 - 49s - loss: 0.0746 - acc: 0.9761 - val_loss: 0.1724 - val_acc: 0.9433

Epoch 00005: val_acc did not improve from 0.96738
Epoch 6/200
 - 48s - loss: 0.0659 - acc: 0.9780 - val_loss: 0.1238 - val_acc: 0.9614

Epoch 00006: val_acc did not improve from 0.96738
Epoch 7/200
 - 48s - loss: 0.0481 - acc: 0.9850 - val_loss: 0.1019 - val_acc: 0.9725

Epoch 00007: val_acc improved from 0.96738 to 0.97253, saving model to optional2_GRU.h5
Epoch 8/200
 - 48s - loss: 0.0612 - acc: 0.9799 - val_loss: 0.1215 - val_acc: 0.9648

Epoch 00008: val_acc did not improve from 0.97253
Epoch 9/200
 - 48s - loss: 0.0453 - acc: 0.9863 - val_loss: 0.0967 - val_acc: 0.9734

Epoch 00009: val_acc improved from 0.97253 to 0.97339, saving model to optional2_GRU.h5
Epoch 10/200
 - 48s - loss: 0.0379 - acc: 0.9885 - val_loss: 0.1071 - val_acc: 0.9665

Epoch 00010: val_acc did not improve from 0.97339
Epoch 11/200
 - 49s - loss: 0.0358 - acc: 0.9890 - val_loss: 0.0681 - val_acc: 0.9803

Epoch 00011: val_acc improved from 0.97339 to 0.98026, saving model to optional2_GRU.h5
Epoch 12/200
 - 49s - loss: 0.0286 - acc: 0.9918 - val_loss: 0.0564 - val_acc: 0.9828

Epoch 00012: val_acc improved from 0.98026 to 0.98283, saving model to optional2_GRU.h5
Epoch 13/200
 - 49s - loss: 0.0276 - acc: 0.9922 - val_loss: 0.0716 - val_acc: 0.9803

Epoch 00013: val_acc did not improve from 0.98283
Epoch 14/200
 - 48s - loss: 0.0312 - acc: 0.9895 - val_loss: 0.0766 - val_acc: 0.9811

Epoch 00014: val_acc did not improve from 0.98283
Epoch 15/200
 - 48s - loss: 0.0182 - acc: 0.9938 - val_loss: 0.2031 - val_acc: 0.9519

Epoch 00015: val_acc did not improve from 0.98283
Epoch 16/200
 - 49s - loss: 0.0416 - acc: 0.9872 - val_loss: 0.1142 - val_acc: 0.9717

Epoch 00016: val_acc did not improve from 0.98283
Epoch 17/200
 - 49s - loss: 0.0293 - acc: 0.9910 - val_loss: 0.0660 - val_acc: 0.9837

Epoch 00017: val_acc improved from 0.98283 to 0.98369, saving model to optional2_GRU.h5
Epoch 18/200
 - 48s - loss: 0.0177 - acc: 0.9948 - val_loss: 0.0719 - val_acc: 0.9803

Epoch 00018: val_acc did not improve from 0.98369
Epoch 19/200
 - 48s - loss: 0.0198 - acc: 0.9942 - val_loss: 0.0654 - val_acc: 0.9837

Epoch 00019: val_acc did not improve from 0.98369
Epoch 20/200
 - 48s - loss: 0.0285 - acc: 0.9912 - val_loss: 0.0861 - val_acc: 0.9751

Epoch 00020: val_acc did not improve from 0.98369
Epoch 21/200
 - 48s - loss: 0.0194 - acc: 0.9938 - val_loss: 0.0730 - val_acc: 0.9742

Epoch 00021: val_acc did not improve from 0.98369
Epoch 22/200
 - 48s - loss: 0.0198 - acc: 0.9937 - val_loss: 0.0592 - val_acc: 0.9803

Epoch 00022: val_acc did not improve from 0.98369
Epoch 23/200
 - 48s - loss: 0.0070 - acc: 0.9979 - val_loss: 0.0415 - val_acc: 0.9906

Epoch 00023: val_acc improved from 0.98369 to 0.99056, saving model to optional2_GRU.h5
Epoch 24/200
 - 48s - loss: 0.0214 - acc: 0.9922 - val_loss: 0.0503 - val_acc: 0.9828

Epoch 00024: val_acc did not improve from 0.99056
Epoch 25/200
 - 48s - loss: 0.0096 - acc: 0.9975 - val_loss: 0.0457 - val_acc: 0.9906

Epoch 00025: val_acc did not improve from 0.99056
Epoch 26/200
 - 48s - loss: 0.0060 - acc: 0.9981 - val_loss: 0.0210 - val_acc: 0.9931

Epoch 00026: val_acc improved from 0.99056 to 0.99313, saving model to optional2_GRU.h5
Epoch 27/200
 - 48s - loss: 0.0251 - acc: 0.9925 - val_loss: 0.0900 - val_acc: 0.9742

Epoch 00027: val_acc did not improve from 0.99313
Epoch 28/200
 - 48s - loss: 0.0199 - acc: 0.9942 - val_loss: 0.0765 - val_acc: 0.9742

Epoch 00028: val_acc did not improve from 0.99313
Epoch 29/200
 - 48s - loss: 0.0381 - acc: 0.9884 - val_loss: 0.0537 - val_acc: 0.9828

Epoch 00029: val_acc did not improve from 0.99313
Epoch 30/200
 - 48s - loss: 0.0182 - acc: 0.9951 - val_loss: 0.0320 - val_acc: 0.9914

Epoch 00030: val_acc did not improve from 0.99313
Epoch 31/200
 - 48s - loss: 0.0086 - acc: 0.9972 - val_loss: 0.0676 - val_acc: 0.9777

Epoch 00031: val_acc did not improve from 0.99313
Epoch 32/200
 - 48s - loss: 0.0132 - acc: 0.9960 - val_loss: 0.0458 - val_acc: 0.9871

Epoch 00032: val_acc did not improve from 0.99313
Epoch 33/200
 - 48s - loss: 0.0121 - acc: 0.9960 - val_loss: 0.0429 - val_acc: 0.9871

Epoch 00033: val_acc did not improve from 0.99313

Epoch 00033: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.
Epoch 34/200
 - 48s - loss: 0.0067 - acc: 0.9983 - val_loss: 0.0260 - val_acc: 0.9940

Epoch 00034: val_acc improved from 0.99313 to 0.99399, saving model to optional2_GRU.h5
Epoch 35/200
 - 48s - loss: 0.0038 - acc: 0.9993 - val_loss: 0.0313 - val_acc: 0.9923

Epoch 00035: val_acc did not improve from 0.99399
Epoch 36/200
 - 48s - loss: 0.0016 - acc: 0.9996 - val_loss: 0.0391 - val_acc: 0.9923

Epoch 00036: val_acc did not improve from 0.99399
Epoch 37/200
 - 48s - loss: 0.0013 - acc: 0.9998 - val_loss: 0.0391 - val_acc: 0.9923

Epoch 00037: val_acc did not improve from 0.99399
Epoch 38/200
 - 48s - loss: 7.2988e-04 - acc: 0.9999 - val_loss: 0.0382 - val_acc: 0.9923

Epoch 00038: val_acc did not improve from 0.99399
Epoch 39/200
 - 48s - loss: 7.5322e-04 - acc: 0.9999 - val_loss: 0.0389 - val_acc: 0.9923

Epoch 00039: val_acc did not improve from 0.99399
Epoch 40/200
 - 48s - loss: 0.0011 - acc: 0.9995 - val_loss: 0.0390 - val_acc: 0.9923

Epoch 00040: val_acc did not improve from 0.99399
Epoch 41/200
 - 48s - loss: 9.0138e-04 - acc: 0.9999 - val_loss: 0.0383 - val_acc: 0.9923

Epoch 00041: val_acc did not improve from 0.99399

Epoch 00041: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.
Epoch 42/200
 - 48s - loss: 3.8401e-04 - acc: 0.9999 - val_loss: 0.0401 - val_acc: 0.9931

Epoch 00042: val_acc did not improve from 0.99399
Epoch 43/200
 - 48s - loss: 2.9777e-04 - acc: 1.0000 - val_loss: 0.0401 - val_acc: 0.9931

Epoch 00043: val_acc did not improve from 0.99399
Epoch 44/200
 - 48s - loss: 3.0187e-04 - acc: 1.0000 - val_loss: 0.0417 - val_acc: 0.9931
Using TensorFlow backend.

Epoch 00044: val_acc did not improve from 0.99399
Epoch 00044: early stopping
Test accuracy score : 0.9948471315699072 
